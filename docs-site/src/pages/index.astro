---
import LandingLayout from '../layouts/LandingLayout.astro';

// Ensure baseUrl ends with /
const rawBase = import.meta.env.BASE_URL;
const baseUrl = rawBase.endsWith('/') ? rawBase : `${rawBase}/`;

// GitHub stars - fetched client-side for live count

// Feature icons as SVG paths
const featureIcons = {
  yaml: 'M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z',
  llm: 'M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z',
  shield: 'M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z',
  runtime: 'M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z',
  plug: 'M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1',
  check: 'M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z',
};

const features = [
  {
    iconPath: featureIcons.yaml,
    title: 'YAML-First',
    description: 'Define complex workflows in simple, readable YAML. No SDK required.',
  },
  {
    iconPath: featureIcons.llm,
    title: 'Any LLM',
    description: 'Anthropic, OpenAI, Ollama, or others with one config change.',
  },
  {
    iconPath: featureIcons.shield,
    title: 'Production Ready',
    description: 'Built-in observability, cost tracking, and security controls.',
  },
  {
    iconPath: featureIcons.runtime,
    title: 'Flexible Runtime',
    description: 'CLI, API server, webhooks, or scheduled execution.',
  },
  {
    iconPath: featureIcons.plug,
    title: 'Connectors',
    description: 'GitHub, Slack, Jira integrations with zero code.',
  },
  {
    iconPath: featureIcons.check,
    title: 'Auditable',
    description: 'Security review YAML, not agent code scattered across codebases.',
  },
];

const useCases = [
  {
    title: 'Code Review Bot',
    description: 'Automated PR reviews with multi-persona feedback.',
    link: `${baseUrl}examples/code-review/`,
  },
  {
    title: 'Issue Triage',
    description: 'Classify and route issues to the right team automatically.',
    link: `${baseUrl}examples/automation/`,
  },
  {
    title: 'Build Failure Analysis',
    description: 'Diagnose CI failures and suggest fixes.',
    link: `${baseUrl}examples/devops/`,
  },
];

const codeExamples = [
  {
    id: 'security-review',
    title: 'Security Review',
    description: 'Review PRs for security issues. Run via CLI, GitHub webhook, or CI pipeline.',
    code: `name: security-review
description: Review PRs for security issues

inputs:
  - name: owner
    type: string
  - name: repo
    type: string
  - name: pr_number
    type: number

steps:
  - id: get_diff
    github.get_pull_request_diff:
      owner: "{{.inputs.owner}}"
      repo: "{{.inputs.repo}}"
      number: "{{.inputs.pr_number}}"

  - id: review
    type: llm
    model: balanced
    prompt: |
      Review this diff for security vulnerabilities.
      Flag any issues found with severity and remediation.

      {{.steps.get_diff.content}}

  - id: comment
    github.create_comment:
      body: "{{.steps.review.response}}"`,
  },
  {
    id: 'iac-review',
    title: 'IaC Review',
    description: 'Run terraform plan, then analyze changes in parallel for risk and network impact.',
    code: `name: iac-review
description: Parallel analysis of infrastructure changes

steps:
  - id: plan
    shell.run: terraform plan -no-color
    workdir: ./infrastructure

  - id: analyze
    type: parallel
    steps:
      - id: risk
        type: llm
        model: balanced
        prompt: |
          Summarize the RISK of these infrastructure changes.
          Flag any security concerns, cost increases, or breaking changes.

          {{.steps.plan.stdout}}

      - id: network
        type: llm
        model: balanced
        prompt: |
          Summarize the NETWORK OPERATIONS impact of these changes.
          Note any IP changes, security group updates, or routing modifications.

          {{.steps.plan.stdout}}

  - id: report
    type: llm
    model: fast
    prompt: |
      Create a brief executive summary combining these analyses:

      ## Risk Assessment
      {{.steps.analyze.risk.response}}

      ## Network Impact
      {{.steps.analyze.network.response}}`,
  },
  {
    id: 'incident-response',
    title: 'Incident Response',
    description: 'Triage alerts and suggest remediation. Trigger via webhook from PagerDuty or Datadog.',
    code: `name: incident-response
description: Triage alerts and suggest remediation

inputs:
  - name: service
    type: string
  - name: message
    type: string

steps:
  - id: triage
    type: parallel
    steps:
      - id: logs
        shell.run: kubectl logs -l app={{.inputs.service}} --tail=50

      - id: changes
        github.list_commits:
          repo: "{{.inputs.service}}"
          since: "24h"

  - id: analyze
    type: llm
    model: balanced
    prompt: |
      Alert for {{.inputs.service}}: {{.inputs.message}}

      Recent logs:
      {{.steps.triage.logs.stdout}}

      Recent commits:
      {{.steps.triage.changes.commits}}

      Provide: 1) Root cause hypothesis  2) Suggested fix

  - id: notify
    slack.post_message:
      channel: "#incidents"
      text: "ðŸš¨ *{{.inputs.service}}*\\n{{.steps.analyze.response}}"`,
  },
  {
    id: 'oncall-handoff',
    title: 'On-Call Handoff',
    description: 'Generate shift handoff summary. Schedule at 9am/9pm or run manually.',
    code: `name: oncall-handoff
description: Generate shift handoff summary

steps:
  - id: gather
    type: parallel
    steps:
      - id: incidents
        pagerduty.list_incidents:
          status: open

      - id: deploys
        github.list_deployments:
          environment: production
          since: "12h"

      - id: issues
        jira.search:
          jql: "priority = Critical AND status != Done"

  - id: summarize
    type: llm
    model: balanced
    prompt: |
      Create a concise on-call handoff:

      Open incidents: {{.steps.gather.incidents}}
      Recent deploys: {{.steps.gather.deploys}}
      Critical issues: {{.steps.gather.issues}}

      Format: What's hot, what to watch, pending actions.

  - id: post
    slack.post_message:
      channel: "#oncall"
      text: "ðŸ“‹ *Shift Handoff*\\n{{.steps.summarize.response}}"`,
  },
];
---

<LandingLayout
  title="Conductor - Portable AI workflows in simple YAML"
  description="Orchestrate LLM agents with built-in observability, cost tracking, and security controls."
>
  <!-- Header -->
  <header class="fixed top-0 left-0 right-0 z-50 bg-white/80 dark:bg-stone-900/80 backdrop-blur-sm border-b border-stone-200 dark:border-stone-800">
    <nav class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
      <a href={baseUrl} class="text-xl font-bold text-stone-900 dark:text-white">
        Conductor
      </a>

      <div class="hidden md:flex items-center gap-6">
        <a href={`${baseUrl}getting-started/`} class="text-stone-600 hover:text-stone-900 dark:text-stone-300 dark:hover:text-white transition-colors">
          Docs
        </a>
        <a href={`${baseUrl}examples/`} class="text-stone-600 hover:text-stone-900 dark:text-stone-300 dark:hover:text-white transition-colors">
          Examples
        </a>
        <a href="https://github.com/tombee/conductor" target="_blank" rel="noopener noreferrer" class="text-stone-600 hover:text-stone-900 dark:text-stone-300 dark:hover:text-white transition-colors">
          GitHub
        </a>
        <button
          id="theme-toggle"
          class="p-2 rounded-lg hover:bg-stone-100 dark:hover:bg-stone-800 transition-colors"
          aria-label="Toggle dark mode"
        >
          <svg class="w-5 h-5 hidden dark:block text-stone-300" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
          </svg>
          <svg class="w-5 h-5 dark:hidden text-stone-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
          </svg>
        </button>
      </div>

      <!-- Mobile menu button -->
      <button
        id="mobile-menu-toggle"
        class="md:hidden p-2 rounded-lg hover:bg-stone-100 dark:hover:bg-stone-800"
        aria-label="Open menu"
        aria-expanded="false"
        aria-controls="mobile-menu"
      >
        <svg class="w-6 h-6 text-stone-600 dark:text-stone-300" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>
    </nav>

    <!-- Mobile menu -->
    <div id="mobile-menu" class="hidden md:hidden border-t border-stone-200 dark:border-stone-800 bg-white dark:bg-stone-900">
      <div class="px-4 py-4 space-y-3">
        <a href={`${baseUrl}getting-started/`} class="block py-2 text-stone-600 dark:text-stone-300">Docs</a>
        <a href={`${baseUrl}examples/`} class="block py-2 text-stone-600 dark:text-stone-300">Examples</a>
        <a href="https://github.com/tombee/conductor" target="_blank" rel="noopener noreferrer" class="block py-2 text-stone-600 dark:text-stone-300">GitHub</a>
      </div>
    </div>
  </header>

  <main id="main-content">
    <!-- Hero Section -->
    <section class="pt-32 pb-20 px-4 sm:px-6 lg:px-8 relative overflow-hidden">
      <!-- Gradient background -->
      <div class="absolute inset-0 bg-gradient-to-b from-amber-50/50 to-transparent dark:from-amber-950/20 dark:to-transparent pointer-events-none"></div>
      <div class="max-w-4xl mx-auto text-center relative">
        <h1 class="text-4xl sm:text-5xl lg:text-6xl font-bold text-stone-900 dark:text-white mb-6 animate-fade-in">
          Portable AI workflows in<br class="hidden sm:block" />
          <span class="text-amber-600 dark:text-amber-400">simple YAML</span>
        </h1>
        <p class="text-xl text-stone-600 dark:text-stone-300 mb-8 max-w-2xl mx-auto">
          Orchestrate LLM agents with built-in observability, cost tracking, and security.
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
          <a
            href={`${baseUrl}getting-started/`}
            class="inline-flex items-center px-6 py-3 rounded-lg bg-amber-600 hover:bg-amber-700 text-white font-medium transition-colors min-w-[160px] justify-center"
          >
            Get Started
          </a>
          <a
            href="https://github.com/tombee/conductor"
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center gap-2 px-6 py-3 rounded-lg border border-stone-300 dark:border-stone-600 hover:bg-stone-50 dark:hover:bg-stone-800 text-stone-700 dark:text-stone-200 font-medium transition-colors min-w-[160px] justify-center"
          >
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd" />
            </svg>
            Star on GitHub
            <span id="github-stars" class="px-2 py-0.5 text-sm bg-stone-100 dark:bg-stone-700 rounded-full">-</span>
            <span class="sr-only">(opens in new tab)</span>
          </a>
        </div>
      </div>
    </section>

    <!-- Code Showcase -->
    <section class="py-16 px-4 sm:px-6 lg:px-8 bg-stone-50 dark:bg-stone-800/50">
      <div class="max-w-4xl mx-auto">
        <!-- Tab buttons -->
        <div class="flex justify-center mb-4" role="tablist" aria-label="Workflow examples">
          {codeExamples.map((example, index) => (
            <button
              role="tab"
              aria-selected={index === 0 ? "true" : "false"}
              aria-controls={`panel-${example.id}`}
              id={`tab-${example.id}`}
              data-example-index={index}
              class={`px-4 py-2 text-sm font-medium rounded-lg mx-1 transition-colors ${
                index === 0
                  ? 'bg-amber-600 text-white'
                  : 'bg-stone-200 dark:bg-stone-700 text-stone-600 dark:text-stone-300 hover:bg-stone-300 dark:hover:bg-stone-600'
              }`}
            >
              {example.title}
            </button>
          ))}
        </div>

        <!-- Description -->
        <p id="example-description" class="text-center text-stone-600 dark:text-stone-300 mb-4">
          {codeExamples[0].description}
        </p>

        <!-- Code panels -->
        <div class="relative">
          <div class="absolute top-3 right-3 z-10">
            <button
              id="copy-code"
              class="p-2 rounded-lg bg-stone-700 hover:bg-stone-600 text-stone-300 transition-colors"
              aria-label="Copy code"
            >
              <svg id="copy-icon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
              </svg>
              <svg id="check-icon" class="w-5 h-5 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
              </svg>
            </button>
          </div>
          {codeExamples.map((example, index) => (
            <div
              role="tabpanel"
              id={`panel-${example.id}`}
              aria-labelledby={`tab-${example.id}`}
              class={index === 0 ? '' : 'hidden'}
              data-panel-index={index}
            >
              <pre class="bg-stone-900 text-stone-100 rounded-xl p-6 overflow-x-auto text-sm leading-relaxed"><code>{example.code}</code></pre>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- Features Grid -->
    <section class="py-20 px-4 sm:px-6 lg:px-8" data-animate>
      <div class="max-w-6xl mx-auto">
        <h2 class="text-3xl font-bold text-center text-stone-900 dark:text-white mb-12">
          Everything you need for production AI workflows
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          {features.map((feature) => (
            <div class="p-6 rounded-xl border border-stone-200 dark:border-stone-700 bg-white dark:bg-stone-800/50 transition-all duration-300 hover:shadow-lg hover:border-amber-300 dark:hover:border-amber-600">
              <div class="w-12 h-12 rounded-lg bg-amber-100 dark:bg-amber-900/50 flex items-center justify-center mb-4">
                <svg class="w-6 h-6 text-amber-600 dark:text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d={feature.iconPath} />
                </svg>
              </div>
              <h3 class="text-lg font-semibold text-stone-900 dark:text-white mb-2">{feature.title}</h3>
              <p class="text-stone-600 dark:text-stone-300">{feature.description}</p>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- Use Cases -->
    <section class="py-20 px-4 sm:px-6 lg:px-8 bg-stone-50 dark:bg-stone-800/50" data-animate>
      <div class="max-w-6xl mx-auto">
        <h2 class="text-3xl font-bold text-center text-stone-900 dark:text-white mb-4">
          Real-world use cases
        </h2>
        <p class="text-center text-stone-600 dark:text-stone-300 mb-12 max-w-2xl mx-auto">
          See how teams use Conductor to automate their workflows.
        </p>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          {useCases.map((useCase) => (
            <a
              href={useCase.link}
              class="group p-6 rounded-xl bg-white dark:bg-stone-800 border border-stone-200 dark:border-stone-700 hover:border-amber-300 dark:hover:border-amber-600 transition-colors"
            >
              <h3 class="text-lg font-semibold text-stone-900 dark:text-white mb-2 group-hover:text-amber-600 dark:group-hover:text-amber-400 transition-colors">
                {useCase.title}
              </h3>
              <p class="text-stone-600 dark:text-stone-300">{useCase.description}</p>
            </a>
          ))}
        </div>
      </div>
    </section>

    <!-- How It Works -->
    <section class="py-20 px-4 sm:px-6 lg:px-8" data-animate>
      <div class="max-w-4xl mx-auto">
        <h2 class="text-3xl font-bold text-center text-stone-900 dark:text-white mb-12">
          How it works
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          {[
            { step: '1', title: 'Write YAML', desc: 'Define your workflow in a simple YAML file' },
            { step: '2', title: 'Configure', desc: 'Set your LLM provider credentials' },
            { step: '3', title: 'Run', desc: 'Execute from CLI, API, or on a schedule' },
            { step: '4', title: 'Iterate', desc: 'Refine prompts and add more steps' },
          ].map((item) => (
            <div class="text-center">
              <div class="w-12 h-12 rounded-full bg-amber-600 text-white font-bold text-xl flex items-center justify-center mx-auto mb-4">
                {item.step}
              </div>
              <h3 class="font-semibold text-stone-900 dark:text-white mb-2">{item.title}</h3>
              <p class="text-sm text-stone-600 dark:text-stone-300">{item.desc}</p>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- CTA Section -->
    <section class="py-20 px-4 sm:px-6 lg:px-8 bg-amber-600 dark:bg-amber-700">
      <div class="max-w-4xl mx-auto text-center">
        <h2 class="text-3xl font-bold text-white mb-4">
          Ready to get started?
        </h2>
        <p class="text-amber-100 mb-8">
          Install Conductor and run your first workflow in minutes.
        </p>
        <div class="bg-stone-900 rounded-lg p-4 max-w-md mx-auto mb-8">
          <code class="text-amber-300 text-sm">go install github.com/tombee/conductor@latest</code>
        </div>
        <a
          href={`${baseUrl}getting-started/`}
          class="inline-flex items-center px-8 py-4 rounded-lg bg-white hover:bg-stone-100 text-amber-700 font-semibold transition-colors"
        >
          Read the Docs
        </a>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="py-12 px-4 sm:px-6 lg:px-8 bg-stone-100 dark:bg-stone-900 border-t border-stone-200 dark:border-stone-800">
    <div class="max-w-6xl mx-auto">
      <div class="grid grid-cols-2 md:grid-cols-4 gap-8 mb-8">
        <div>
          <h4 class="font-semibold text-stone-900 dark:text-white mb-4">Getting Started</h4>
          <ul class="space-y-2 text-sm">
            <li><a href={`${baseUrl}getting-started/`} class="text-stone-600 dark:text-stone-400 hover:text-stone-900 dark:hover:text-white">Quick Start</a></li>
            <li><a href={`${baseUrl}tutorial/`} class="text-stone-600 dark:text-stone-400 hover:text-stone-900 dark:hover:text-white">Tutorial</a></li>
            <li><a href={`${baseUrl}concepts/`} class="text-stone-600 dark:text-stone-400 hover:text-stone-900 dark:hover:text-white">Concepts</a></li>
          </ul>
        </div>
        <div>
          <h4 class="font-semibold text-stone-900 dark:text-white mb-4">Features</h4>
          <ul class="space-y-2 text-sm">
            <li><a href={`${baseUrl}features/actions/`} class="text-stone-600 dark:text-stone-400 hover:text-stone-900 dark:hover:text-white">Actions</a></li>
            <li><a href={`${baseUrl}features/integrations/`} class="text-stone-600 dark:text-stone-400 hover:text-stone-900 dark:hover:text-white">Integrations</a></li>
            <li><a href={`${baseUrl}features/triggers/`} class="text-stone-600 dark:text-stone-400 hover:text-stone-900 dark:hover:text-white">Triggers</a></li>
          </ul>
        </div>
        <div>
          <h4 class="font-semibold text-stone-900 dark:text-white mb-4">Examples</h4>
          <ul class="space-y-2 text-sm">
            <li><a href={`${baseUrl}examples/code-review/`} class="text-stone-600 dark:text-stone-400 hover:text-stone-900 dark:hover:text-white">Code Review</a></li>
            <li><a href={`${baseUrl}examples/devops/`} class="text-stone-600 dark:text-stone-400 hover:text-stone-900 dark:hover:text-white">DevOps</a></li>
            <li><a href={`${baseUrl}examples/automation/`} class="text-stone-600 dark:text-stone-400 hover:text-stone-900 dark:hover:text-white">Automation</a></li>
          </ul>
        </div>
        <div>
          <h4 class="font-semibold text-stone-900 dark:text-white mb-4">Community</h4>
          <ul class="space-y-2 text-sm">
            <li><a href="https://github.com/tombee/conductor" target="_blank" rel="noopener noreferrer" class="text-stone-600 dark:text-stone-400 hover:text-stone-900 dark:hover:text-white">GitHub</a></li>
            <li><a href="https://github.com/tombee/conductor/issues" target="_blank" rel="noopener noreferrer" class="text-stone-600 dark:text-stone-400 hover:text-stone-900 dark:hover:text-white">Issues</a></li>
            <li><a href="https://github.com/tombee/conductor/discussions" target="_blank" rel="noopener noreferrer" class="text-stone-600 dark:text-stone-400 hover:text-stone-900 dark:hover:text-white">Discussions</a></li>
          </ul>
        </div>
      </div>
      <div class="border-t border-stone-200 dark:border-stone-800 pt-8 flex flex-col sm:flex-row justify-between items-center gap-4 text-sm text-stone-600 dark:text-stone-400">
        <p>Apache 2.0 License</p>
        <p>No tracking cookies used</p>
      </div>
    </div>
  </footer>

  <script>
    // Fetch GitHub stars
    const starsEl = document.getElementById('github-stars');
    fetch('https://api.github.com/repos/tombee/conductor')
      .then(res => res.json())
      .then(data => {
        if (data.stargazers_count !== undefined) {
          const count = data.stargazers_count;
          starsEl.textContent = count >= 1000 ? `${(count / 1000).toFixed(1)}k` : count.toString();
          starsEl.setAttribute('aria-label', `${count} stars`);
        }
      })
      .catch(() => {
        starsEl.textContent = '0';
      });

    // Theme toggle
    const themeToggle = document.getElementById('theme-toggle');
    themeToggle?.addEventListener('click', () => {
      document.documentElement.classList.toggle('dark');
      const isDark = document.documentElement.classList.contains('dark');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
    });

    // Mobile menu
    const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
    const mobileMenu = document.getElementById('mobile-menu');

    mobileMenuToggle?.addEventListener('click', () => {
      const isOpen = mobileMenu?.classList.toggle('hidden') === false;
      mobileMenuToggle.setAttribute('aria-expanded', isOpen.toString());
    });

    // Close mobile menu on escape
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && !mobileMenu?.classList.contains('hidden')) {
        mobileMenu?.classList.add('hidden');
        mobileMenuToggle?.setAttribute('aria-expanded', 'false');
      }
    });

    // Example tabs
    const exampleDescriptions = [
      'Review PRs for security issues. Run via CLI, GitHub webhook, or CI pipeline.',
      'Run terraform plan, then analyze changes in parallel for risk and network impact.',
      'Triage alerts and suggest remediation. Trigger via webhook from PagerDuty or Datadog.',
      'Generate shift handoff summary. Schedule at 9am/9pm or run manually.',
    ];
    const tabs = document.querySelectorAll('[role="tab"]');
    const panels = document.querySelectorAll('[role="tabpanel"]');
    const descriptionEl = document.getElementById('example-description');

    tabs.forEach((tab) => {
      tab.addEventListener('click', () => {
        const index = parseInt(tab.getAttribute('data-example-index') || '0', 10);

        // Update tab states
        tabs.forEach((t, i) => {
          const isSelected = i === index;
          t.setAttribute('aria-selected', isSelected.toString());
          t.classList.toggle('bg-amber-600', isSelected);
          t.classList.toggle('text-white', isSelected);
          t.classList.toggle('bg-stone-200', !isSelected);
          t.classList.toggle('dark:bg-stone-700', !isSelected);
          t.classList.toggle('text-stone-600', !isSelected);
          t.classList.toggle('dark:text-stone-300', !isSelected);
        });

        // Update panels
        panels.forEach((panel, i) => {
          panel.classList.toggle('hidden', i !== index);
        });

        // Update description
        if (descriptionEl) {
          descriptionEl.textContent = exampleDescriptions[index];
        }
      });
    });

    // Copy code button
    const copyButton = document.getElementById('copy-code');
    const copyIcon = document.getElementById('copy-icon');
    const checkIcon = document.getElementById('check-icon');

    copyButton?.addEventListener('click', async () => {
      // Find the visible panel's code
      const visiblePanel = document.querySelector('[role="tabpanel"]:not(.hidden)');
      const codeContent = visiblePanel?.querySelector('code');

      try {
        await navigator.clipboard.writeText(codeContent?.textContent || '');
        copyIcon?.classList.add('hidden');
        checkIcon?.classList.remove('hidden');
        setTimeout(() => {
          copyIcon?.classList.remove('hidden');
          checkIcon?.classList.add('hidden');
        }, 2000);
      } catch {
        // Fallback: select text
        const range = document.createRange();
        if (codeContent) {
          range.selectNodeContents(codeContent);
          const selection = window.getSelection();
          selection?.removeAllRanges();
          selection?.addRange(range);
        }
      }
    });

    // Scroll animations with Intersection Observer
    // Only run if user hasn't requested reduced motion
    if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
      const animatedSections = document.querySelectorAll('[data-animate]');

      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              entry.target.classList.add('animate-visible');
              observer.unobserve(entry.target);
            }
          });
        },
        { threshold: 0.1, rootMargin: '0px 0px -50px 0px' }
      );

      animatedSections.forEach((section) => {
        section.classList.add('animate-on-scroll');
        observer.observe(section);
      });
    }
  </script>

  <style>
    /* Scroll animation styles */
    .animate-on-scroll {
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.6s ease-out, transform 0.6s ease-out;
    }

    .animate-visible {
      opacity: 1;
      transform: translateY(0);
    }

    /* Respect reduced motion preference */
    @media (prefers-reduced-motion: reduce) {
      .animate-on-scroll {
        opacity: 1;
        transform: none;
        transition: none;
      }
    }

    /* Screen reader only - visually hidden but accessible */
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }
  </style>
</LandingLayout>
