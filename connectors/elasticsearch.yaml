# Elasticsearch Connector Package
# Official connector for Elasticsearch document indexing

version: "1.0"
name: elasticsearch
description: Elasticsearch document indexing connector

# Base URL configured per-workflow
# Example: https://elasticsearch.example.com:9200

# Elasticsearch rate limits vary by cluster
# Conservative defaults
rate_limit:
  requests_per_second: 10
  requests_per_minute: 500

operations:
  # Index a Single Document
  index:
    method: POST
    path: /{index}/_doc/{id}
    # Path supports templates: {index} and optional {id}
    # If id is omitted, Elasticsearch auto-generates it
    request_schema:
      type: object
      properties:
        index:
          type: string
          description: Index name (uses connector default if omitted, supports date math)
        document:
          type: object
          description: Document to index
        id:
          type: string
          description: Document ID (auto-generated if omitted)
        refresh:
          type: string
          description: Refresh policy (true, false, wait_for)
          enum: [true, false, wait_for]
        pipeline:
          type: string
          description: Ingest pipeline name
        routing:
          type: string
          description: Custom routing value
      required: [document]
    response_transform: "{_index, _id, _version, result}"

  # Bulk Index Multiple Documents
  bulk:
    method: POST
    path: /_bulk
    # Content-Type: application/x-ndjson
    request_schema:
      type: object
      properties:
        index:
          type: string
          description: Default index for all documents
        documents:
          type: array
          description: Array of documents to index
          items:
            type: object
            properties:
              _index:
                type: string
                description: Override index for this document
              _id:
                type: string
                description: Document ID (auto-generated if omitted)
            additionalProperties: true
        refresh:
          type: string
          description: Refresh policy applied after bulk
          enum: [true, false, wait_for]
        pipeline:
          type: string
          description: Default ingest pipeline
      required: [documents]
    response_transform: "{took, errors, items}"
